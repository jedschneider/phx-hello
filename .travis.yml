language: elixir
elixir:
- 1.7.4
otp_release:
- '20.0'

cache:
  directories:
    - deps
env:
  global:
  - LOCAL_POSTGRES_USERNAME=postgres LOCAL_POSTGRES_PASSWORD=postgres
services: "-postgesql"
addons:
  postgresql: '9.6'
sudo: false
install:
- mix local.rebar --force
- mix local.hex --force
- mix deps.get
script:
- mix test

jobs:
  include:
    - stage: auth_check
      name: "Auth check"
      script: ./auth_check
